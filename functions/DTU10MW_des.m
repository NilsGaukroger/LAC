function [c,that,beta,t,x] = DTU10MW_des(plt,dis)
% Design polynomial splines for the DTU 10MW

% Chord
c_breaks = [2.8000 8.1960 19.9548 28.0124 38.2220 55.0271 70.0576 78.1586 85.0000 86.2521 88.6595 88.9861 89.1660];
c_coeffs = [
    0.00000000E+00 0.00000000E+00 0.00000000E+00 5.38000000E+00;
    -4.61301443E-04 1.04228497E-02 0.00000000E+00 5.38000000E+00;
    9.54064544E-05 -5.85020456E-03 5.37688193E-02 6.07113924E+00;
    7.94309215E-05 -3.54396342E-03 -2.19256287E-02 6.17447367E+00;
    2.42467032E-05 -1.11108961E-03 -6.94518582E-02 5.66574440E+00;
    8.59761392E-06 1.11315203E-04 -8.62531671E-02 4.29988830E+00;
	4.71207167E-06 4.98994511E-04 -7.70799070E-02 3.05780226E+00;
	-4.39083118E-04 6.13511989E-04 -6.80674918E-02 2.46863016E+00;
    -1.32866948E-03 -8.39831774E-03 -1.21326462E-01 1.89106967E+00;
    -1.47600180E-02 -1.33891816E-02 -1.48606495E-01 1.72338280E+00;
	-6.79818589E+00 -1.19989176E-01 -4.69702133E-01 1.08209177E+00;
	1.04359293E+01 -6.78085172E+00 -2.72351677E+00 6.79055450E-01];
c = ppmak(c_breaks,c_coeffs,1);

% Relative thickness
that_breaks = [2.8 4.8 18.8310 27.1510 37.424 63.615 89.166];
that_coeffs = 100*[
    0.00000000E+00 0.00000000E+00 0.00000000E+00 1.00000000E+00
    1.63195479E-04 -4.64026965E-03 0.00000000E+00 1.00000000E+00
    -6.94374457E-05 2.22911763E-03 -3.38308740E-02 5.37264647E-01
    -1.19564154E-05 4.95958990E-04 -1.11582365E-02 3.70105515E-01
    -9.34760029E-07 1.27474224E-04 -4.75370706E-03 2.94855128E-01
    0.00000000E+00 0.00000000E+00 0.00000000E+00 2.41000000E-01
    ];
that = ppmak(that_breaks,that_coeffs,1);

% Twist
beta_breaks = [2.8 9.119 15.5543 21.3482 30.1888 43.4352 57.5373 89.1660];
beta_coeffs = [
	0.00000000E+00 0.00000000E+00 0.00000000E+00 1.45000000E+01
	-1.94790140E-03 -1.76633017E-02 0.00000000E+00 1.45000000E+01
	 5.39990815E-03 -5.52692913E-02 -4.69343116E-01 1.32493815E+01
	 -1.35567415E-03 3.85902922E-02 -5.65979568E-01 9.72497036E+00
	 -1.20591403E-04 2.63537363E-03 -2.01519947E-01 6.80074227E+00
	 9.58895526E-05 -2.15683227E-03 -1.95180996E-01 4.31345834E+00
	 -1.48680703E-05 1.89989991E-03 -1.98804282E-01 1.40098858E+00
	];
beta = ppmak(beta_breaks,beta_coeffs,1);

% Plot polynomials
if plt == 1
    poly = [c,that,beta];
    x = linspace(2.8,89.166,dis);
    labels = ["Chord [m]", "Relative thickness [%]", "Twist [deg]"];
    figure
    for i = 1:length(poly)
        subplot(3,1,i)
        plot(x,fnval(poly(i),x))
        ylabel(labels(i));
        grid on
    end
    xlabel('Radius [m]')
    sgtitle('DTU 10MW Geometry')
else
end

% Absolute thickness
t = fnval(c,x) .* (fnval(that,x)/100);
end